---

- hosts: all
  vars:
    docker_version: 1.12.1
    ob: '{'
  roles:
    # install very old version of Docker
    - role: docker
  tasks:
    - name: verify that Docker is running and accessible
      command: docker ps
    - name: get docker client version
      command: "docker version -f '{{ ob }}{ .Client.Version }}'"
      register: docker_client_version_result
    - name: get docker client version
      command: "docker version -f '{{ ob }}{ .Server.Version }}'"
      register: docker_server_version_result
    - name: check version results
      assert:
        that:
          - "{{ docker_client_version_result.stdout == docker_version }}"
          - "{{ docker_server_version_result.stdout == docker_version }}"
